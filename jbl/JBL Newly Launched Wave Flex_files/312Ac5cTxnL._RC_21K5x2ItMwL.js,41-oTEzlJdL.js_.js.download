(function(g){var k=window.AmazonUIPageJS||window.P,m=k._namespace||k.attributeErrors,f=m?m("NileInlineCustomerExperienceWidgetCommonAssets",""):k;f.guardFatal?f.guardFatal(g)(f,window):f.execute(function(){g(f,window)})})(function(g,k,m){g.now("nile-inline-error-chunk-handler").execute(function(f){f||g.when("A","nile-inline-loader-utils","nile-inline-element-prefix-utils","ready").register("nile-inline-error-chunk-handler",function(d,b,a){return{handleChunk:function(e,g){var c=a.prefixed("nile-inline-hidden");
if(d.$(a.prefixedId("nile-inline-answer-generic-error")).hasClass(c)){b.hideLoader();b.hideTrailingLoader();var h=a.prefixedId("nile-inline-answer-container");d.$(h).removeClass(c);h=a.prefixedId("nile-inline-answer-text-container-error");d.$(h).removeClass(c);d.$(h).addClass(a.prefixed("nile-inline-text-container-collapsed-error"));var f=a.prefixedId("nile-inline-ai-generated-label");"sensitive_chunk"===g?d.$(f).addClass(c):d.$(f).removeClass(c);d.$(h).html(e)}}}})});g.now("nile-inline-feedback-chunk-handler").execute(function(f){f||
g.when("A","nile-inline-element-prefix-utils","nile-inline-feedback-actions","ready").register("nile-inline-feedback-chunk-handler",function(d,b,a){return{handleChunk:function(e){e=d.$(e);d.$(b.prefixedId("nile-inline-feedback-container")).html(e);a.showFeedback();return e}}})});g.now("nice-srp-utils").execute(function(f){f||g.when("A","ready").register("nice-srp-utils",function(d){function b(l,a){l=(l||"").split(".").map(Number);for(a=(a||"").split(".").map(Number);l.length<a.length;)l.push(0);for(;a.length<
l.length;)a.push(0);for(var c=0;c<l.length;++c)if(l[c]!==a[c])return l[c]>a[c]?1:-1;return 0}function a(){var a=c();return"Amazon"===a.name||"Amazon.com"===a.name}var e=d.$,f=[],c=function(){var a;return function(){if(!a){var c=document.cookie.match(/(?:^|;)\s*amzn-app-id\s*=\s*([^\s;]+)/);c=c?c[1].split("/"):[];var b=/(?:^|;)\s*micron\s*=\s*1\s*(?:$|;)/.test(document.cookie);a={name:c[0],version:c[1],isMicron:b}}return a}}(),h=function(){var a;return function(){if(!a){var c=document.cookie.match(/(?:^|;)\s*session-id\s*=\s*([^\s;]+)/);
c&&(a=c[1])}return a}}(),g=function(){var a;return function(){if(!a){var c=document.cookie.match(/(?:^|;)\s*amzn-app-ctxt\s*=\s*\d\.\d?\s*([^\s;]+)/);if(c)try{a=JSON.parse(decodeURIComponent(c[1]))}catch(n){}}return a}}();return{getAppInfo:c,getAppSessionId:h,getAppContext:g,makeIdempotent:function(a){var c=!1;return function(){c||(a.apply(this,arguments),c=!0)}},makeRateLimited:function(a,c){var b=!1,d=e.extend(!0,{},{minPeriodInMilliseconds:2E3},c);return function(){b||a.apply(this,arguments);b=
!0;setTimeout(function(){b=!1},d.minPeriodInMilliseconds)}},idempotentDeclarative:function(a,c,b){function e(a,c,b){var e;d.declarative(a,c,function(a){e===m&&(e=a.type);a.type===e&&b(a)})}var h=a+c;f[h]||("click touchstart"===c||"touchstart click"===c?e(a,c,b):d.declarative(a,c,b),f[h]=!0)},goToUrl:function(a){k.location.href=a},isMshop:a,isAppXSupported:function(){var e=c();return a()&&e.version&&!e.isMicron?Number(e.version.split(".")[0])%2?0<=b(e.version,"15.11"):0<=b(e.version,"20.8"):!1},truncateURIComponent:function(a,
c,b){if(!a||encodeURIComponent(a).length<=c)return a;b=b||"…";c-=encodeURIComponent(b).length;for(var e="",d=0,h=a.length-1;d<=h;){var f=Math.floor((h+d)/2),g=a.slice(0,f);encodeURIComponent(g).length<=c?(e=g,d=f+1):h=f-1}return e+b},decodeHtmlEntities:function(a){var c=document.createElement("textarea");c.innerHTML=a;return c.value}}})});g.now("nile-inline-csm").execute(function(f){f||g.when("A","ready").register("nile-inline-csm",function(){function d(b,a,e){"function"===typeof uet&&(e?uet(b,a,
{wb:1},e):uet(b,a,{wb:1}))}return{recordRequestStart:function(b,a){"string"===typeof b&&b.trim()&&d("bb",b,a)},recordFirstInferenceLatency:function(b){"string"===typeof b&&b.trim()&&(d("be",b),"function"===typeof uex&&uex("ld",b,{wb:1}))},recordCsmCount:function(b){ue.count(b,1)}}})});g.now("nile-inline-csrf").execute(function(f){f||g.when("A","ready").register("nile-inline-csrf",function(d){return{getRawCsrfToken:function(b){return d.$(b).find("input[name\x3danti-csrftoken-a2z]").val()}}})});g.now("nile-inline-element-prefix-utils").execute(function(f){f||
g.when("ready").register("nile-inline-element-prefix-utils",function(){var d="";return{setupElementPrefix:function(b){d=b+"-"},prefixed:function(b){return d+b},prefixedId:function(b){return"#"+d+b}}})});g.now("nile-inline-loader-utils").execute(function(f){f||g.when("A","nile-inline-element-prefix-utils","ready").register("nile-inline-loader-utils",function(d,b){return{showTrailingLoader:function(){var a=b.prefixed("nile-inline-hidden");var e=b.prefixedId("nile-inline-feedback-container");(e=!d.$(e).hasClass(a)&&
0<d.$(e).children().length)||(e=b.prefixedId("nile-inline-answer-generic-error"),e=!d.$(e).hasClass(a)&&0<d.$(e).children().length);e||(e=b.prefixedId("nile-inline-answer-text-container-error"),e=!d.$(e).hasClass(a)&&0<d.$(e).children().length);e||d.$(b.prefixedId("nile-trailing-loader")).removeClass(a)},hideTrailingLoader:function(){var a=b.prefixed("nile-inline-hidden");d.$(b.prefixedId("nile-trailing-loader")).addClass(a)},showLoader:function(){var a=b.prefixed("nile-inline-hidden");d.$(b.prefixedId("nile-inline-data-container")).removeClass(a);
d.$(b.prefixedId("nile-inline-loader-spinner")).removeClass(a)},hideLoader:function(){var a=b.prefixed("nile-inline-hidden");d.$(b.prefixedId("nile-inline-loader-spinner")).addClass(a);d.$(b.prefixedId("nile-inline-data-container")).addClass(a)}}})});g.now("nile-inline-state-manager").execute(function(f){f||g.when("A","nile-inline-element-prefix-utils","ready").register("nile-inline-state-manager",function(d,b){function a(){return b.prefixed("nice-state")}return{getState:function(){return d.state(a())},
setState:function(b){d.state.replace(a(),b)},extend:function(b){d.state(a(),b)}}})});g.now("nile-inline-uuid-generator").execute(function(f){f||g.when("A","ready").register("nile-inline-uuid-generator",function(d){return{generateUuid:function(){function b(){var a=new Uint32Array(4);k.crypto.getRandomValues(a);var b=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){b++;var e=a[b>>3]>>b%8*4&15;return("x"===c?e:e&3|8).toString(16)})}function a(){function a(){return Math.floor(65536*
(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}return function(){return"undefined"!=typeof k.crypto&&"undefined"!=typeof k.crypto.getRandomValues?b():a()}}()}})});g.now("nile-inline-event-stream-builder").execute(function(f){f||g.when("A","jQuery","ready").register("nile-inline-event-stream-builder",function(d,b){function a(a){this.url=a;this.eventListeners={};this.connectionSuccessfullyClosedCallback=this.errorCallback=this.httpRequest=m}function e(a){var c=
a.newMessage();return function(b,d){if(0===b.length){if(c.type in a.eventListeners)a.eventListeners[c.type](c);c=a.newMessage()}else if(0<d){var e=b.slice(0,d);b=b.slice(d+(" "===b[d+1]?2:1));switch(e){case "data":c.data=c.data?c.data+"\n"+b:b;break;case "event":c.type=b;break;case "id":c.lastEventId=b;break;case "retry":e=parseInt(b,10),isNaN(e)||(c.retry=e,a.retryCallback(c.retry))}}}}function f(a){var c=0,b=-1,d=!1;return function(e){for(var f=e.length,g=c;c<f;){d&&"\n"===e[c]&&(g=++c);for(var h=
-1;c<f&&-1===h;++c)switch(e[c]){case ":":-1===b&&(b=c-g);break;case "\r":d=!0;h=c;break;case "\n":h=c}if(-1===h)break;a(e.slice(g,h),b);g=c;b=-1}g!==f&&0!==g&&(c=g)}}a.prototype.addEventListener=function(a,b){this.eventListeners[a]=b};a.prototype.setErrorCallback=function(a){this.errorCallback=a};a.prototype.setConnectionSuccessfullyClosedCallback=function(a){this.connectionSuccessfullyClosedCallback=a};a.prototype.newMessage=function(){return{lastEventId:"",type:"",data:""}};a.prototype.isSuccessfulStatusCode=
function(a){return 0===a||200<=a&&300>a};a.prototype.buildRequestStageChangeCallback=function(a){return function(){switch(a.httpRequest.readyState){case XMLHttpRequest.DONE:a.isSuccessfulStatusCode(a.httpRequest.status)?a.connectionSuccessfullyClosedCallback!==m&&a.connectionSuccessfullyClosedCallback():a.errorCallback!==m&&a.errorCallback()}}};a.prototype.buildOnProgressCallback=function(a,b){return function(){b(a.httpRequest.responseText)}};a.prototype.retryCallback=function(a){};a.prototype.startPostStream=
function(a,b,d){var c=f(e(this));this.httpRequest=new XMLHttpRequest;this.httpRequest.onreadystatechange=this.buildRequestStageChangeCallback(this);this.httpRequest.onprogress=this.buildOnProgressCallback(this,c);this.httpRequest.ontimeout=this.errorCallback;this.httpRequest.onerror=this.errorCallback;this.httpRequest.open("POST",this.url,!0);this.httpRequest.timeout=d;this.httpRequest.setRequestHeader("accept","text/event-stream");this.httpRequest.setRequestHeader("Content-Type","application/json");
this.httpRequest.setRequestHeader("anti-csrftoken-a2z",b);this.httpRequest.send(JSON.stringify(a))};a.prototype.close=function(a){this.httpRequest.onerror=function(){};this.httpRequest.abort()};return{buildStreamingEndpointCall:function(b){return new a(b)}}})});g.now("nile-inline-collapse-bottom-sheet").execute(function(f){f||g.when("A","nile-inline-element-prefix-utils").register("nile-inline-collapse-bottom-sheet",function(d,b){return{registerCollapseBottomSheetActions:function(){var a=b.prefixed("nile-inline-widget");
a=d.$("[data-component-type\x3d"+a+"]");if(1===a.length||1===a.parent().length){a=a.parent()[0];var e=!1;(new IntersectionObserver(function(a){e?a[0].isIntersecting?g.when("mash").execute(function(a){a.dispatchEvent({type:"nice:inViewPort"})}):g.when("mash").execute(function(a){a.dispatchEvent({type:"nice:outViewPort"})}):e=!0},{threshold:.05})).observe(a)}}}})})});
/* ******** */
'use strict';(function(c){var h=window.AmazonUIPageJS||window.P,k=h._namespace||h.attributeErrors,b=k?k("NileInlineCustomerExperienceWidgetDPXRexAssets@ask",""):h;b.guardFatal?b.guardFatal(c)(b,window):b.execute(function(){c(b,window)})})(function(c,h,k){c.now("askSearch").execute(function(b){b||c.when("A","jQuery","rufusAskExpander","ready").register("askSearch",function(l,d,a){function b(){c&&c.abort();d(".askAnswerContainer").remove()}var c;return{setupExpander:function(){a.setupDesktopSeeMoreLessToggle();
a.setupMobileExpander()},executeSearch:function(a,g,m){m&&b();a={indicator:d("#ask-only-spinner"),params:{asin:a,query:g,isBlue:m},timeout:1E4,success:function(a){b();d("#ask-answer-container").append(a)}};c=l.get("/rufus/web/askSearch",a)},clearSearch:b}})});c.now("rufusAskExpander").execute(function(b){b||c.when("A","jQuery","ready").register("rufusAskExpander",function(b,d){return{setupDesktopSeeMoreLessToggle:function(){d(document).delegate(".askSeeMore","click",function(a){d(a.currentTarget).closest(".askExpanderContainer").addClass("askExpanderExpanded");
a.preventDefault()});d(document).delegate(".askSeeLess","click",function(a){d(a.currentTarget).parents(".askExpanderContainer").removeClass("askExpanderExpanded");a.preventDefault()})},setupMobileExpander:function(){b.on("a:expander:askMobileLiveSearchResultExpander:toggle:expand",function(a){a=a.expander.$expander;a.find(".askMobileLiveSearchResultHeaderTextExpanded").css("display","block");a.find(".askMobileLiveSearchResultHeaderTextCollapsed").hide()});b.on("a:expander:askMobileLiveSearchResultExpander:toggle:collapse",
function(a){a=a.expander.$expander;a.find(".askMobileLiveSearchResultHeaderTextExpanded").hide();a.find(".askMobileLiveSearchResultHeaderTextCollapsed").css("display","block")})}}})});c.now("askAbstractPostQuestion").execute(function(b){b||c.when("A","ready").register("askAbstractPostQuestion",function(b){var d=b.$,a={postQuestionTextInputSelector:"input",callbacks:{goodQuestion:function(){},badQuestion:function(){},emptyQuestion:function(){}}};return{setup:function(c,l){var f=d.extend(!0,{},a,l),
g=!1;if(f.modalName)b.on("a:popover:beforeShow:"+f.modalName,function(a){g=!1});if(f.bottomSheetName)b.on("a:sheet:beforeShow:"+f.bottomSheetName,function(a){g=!1});b.declarative(c,"click",function(){var a=d(f.postQuestionTextInputSelector).find("input").andSelf().filter("input").val();a||(a=d(f.postQuestionTextInputSelector).find("textarea").andSelf().filter("textarea").val());var b=d(f.formSelector+" .promptPostQuestionTextInput"),c=d(f.modalFormSelector+" textarea");a=c.length?c.val():b.length?
b.val():a;"undefined"===typeof a||a.match(/^\s*$/)?f.callbacks.emptyQuestion():g?f.callbacks.goodQuestion():-1===a.indexOf("?")&&-1===a.indexOf("؟")?(f.callbacks.badQuestion(),g=!0):f.callbacks.goodQuestion()})}}})});c.now("askPostQuestion").execute(function(b){b||c.when("A","askAbstractPostQuestion","nile-inline-csrf","nile-inline-state-manager","ready").register("askPostQuestion",function(b,c,a,h){function d(a){e(".askMobilePostQuestionSuccessContainer").find(".post-success-response").html(a);g(".askMobilePostQuestionSuccessContainer")}
function f(a){if(401===a.status||466===a.status)e(".askMobilePostQuestionFormInBottomSheet").submit();else{a=a.http.responseText;var b=e(".askMobilePostQuestionFailureContainer").find(".failureDefaultMsg");a&&0<a.length?(e(".askMobilePostQuestionFailureContainer").find(".failureResponseMsg").html(a),b.hide()):b.show();g(".askMobilePostQuestionFailureContainer")}}function g(a,b){b=b||e("#ask-mobile-post-question-modal-container");b.children().hide();a=b.find(a);a.removeClass("aok-hidden");a.show()}
function m(c,d,f){var g={};e.each(c.serializeArray(),function(a,b){g[b.name]=b.value});g.askAsin=h.getState().asin;b.post(c.attr("action"),{withCredentials:!0,params:JSON.stringify(g),paramsFormat:"json",headers:{"anti-csrftoken-a2z":a.getRawCsrfToken("#rufusInlineCsrfTokenContainer"),"Content-Type":"application/json"},timeout:1E4,indicator:e(".askMobilePostQuestionSpinner"),success:d,error:f})}var e=b.$,k=null,l={postQuestionTextInputSelector:"#ask-mobile-post-question-modal-container .askMobilePostQuestionInput",
bottomSheetName:"ask-mobile-post-question-modal",callbacks:{goodQuestion:function(){e(".askMobilePostQuestionSubmitButtons").hide();e(".askMobilePostQuestionMsgContainer").children().hide();m(e(".askMobilePostQuestionFormInBottomSheet"),d,f)},badQuestion:function(){g(".askBadQuestionError",e(".askMobilePostQuestionMsgContainer"))},emptyQuestion:function(){g(".askEmptyQuestionError",e(".askMobilePostQuestionMsgContainer"))}}};return{registerDeclarativeActions:function(){var a=function(){var a=e("*[id*\x3dask-mobile-post-question-modal]");
1<a.length&&0<e(".a-sheet-content-container #ask-mobile-post-question-modal").length&&a.each(function(){0>=e(this).closest(".a-sheet-content-container").length&&e(this).remove()})},d=function(b){a();b=e("#dpx-rex-nile-search-text-input").val();if(k!==b){var c=e("#ask-mobile-post-question-modal-container .askMobilePostQuestionInput").find("input").andSelf().filter("input");c&&0!==c.length||(c=e("#ask-mobile-post-question-modal-container .askMobilePostQuestionInput").find("textarea").andSelf().filter("textarea"));
c.val(b);k=b}e(".askMobilePostQuestionMsgContainer").children().hide();g(".askMobilePostQuestionFormInBottomSheet");e(".askMobilePostQuestionSubmitButtons").show()};b.on("a:sheet:beforeShow:ask-mobile-post-question-modal",d);b.on("a:popover:beforeShow:ask-mobile-post-question-modal",d);b.declarative("ask-mobile-post-question-input-keyup","keypress",function(a){a&&a.$event&&13===a.$event.which&&a.$event.preventDefault()});c.setup("ask-mobile-post-question-submit",l)}}})})});
/* ******** */
'use strict';(function(d){var x=window.AmazonUIPageJS||window.P,p=x._namespace||x.attributeErrors,n=p?p("NileInlineCustomerExperienceWidgetDPXRexAssets@rufus",""):x;n.guardFatal?n.guardFatal(d)(n,window):n.execute(function(){d(n,window)})})(function(d,x,p){(function(){d.now("nile-inline-answer-chunk-handler").execute(function(f){f||d.when("A","jQuery","a-truncate","nile-inline-html-truncator","nile-inline-loader-utils","dpx-rex-nile-inline-display-utils","ready").register("nile-inline-answer-chunk-handler",
function(a,l,z,g,h,e){function c(c){return c.filter('[id^\x3d"section_groupId_"]').map(function(){return this.id}).get()}function d(a,e,g){c(g).forEach(function(c){var m=c.includes("related_questions")?e:a,h=g.filter("#"+c);c=m.find("#"+c);if(c.length){m=parseInt(c.attr("data-ask-sequenceId"));var l=parseInt(h.attr("data-ask-sequenceId"));if(isNaN(m)||isNaN(l)||m<=l)c.html(h.html()),c.attr("data-ask-sequenceId",h.attr("data-ask-sequenceId"))}else m.append(h)})}var f=a.$("#dpx-rex-nile-inline-see-more-outer");
return{handleChunk:function(c){var a=l("#dpx-rex-nile-inline-answer-text-container"),z=l("#dpx-rex-nile-inline-followon-pills-outside-container");if(c=c.trim()){h.hideLoader();e.show("#dpx-rex-nile-inline-answer-container");var u=l(c);c=u[0]&&u[0].dataset.askBlueChunkType?u:l("\x3cdiv/\x3e").append(c);d(a,z,l(c));g.maybeTruncate(a,f,9);return a}}}})});d.now("nile-inline-chunk-renderer").execute(function(f){f||d.when("A","nile-inline-answer-chunk-handler","nile-inline-error-chunk-handler","nile-inline-feedback-chunk-handler",
"nile-inline-state-manager","dpx-nile-inline-constants").register("nile-inline-chunk-renderer",function(a,l,z,g,h,e){return{renderChunk:function(c,a){a.beforeChunk(c);if("CONTEXT_CHUNK"===c.type)c=JSON.parse(c.data).requestContext,h.getState()&&c&&h.extend({conversationHistoryId:c.conversationHistoryId,requestId:c.requestId});else if("chunk"===c.type){var d=JSON.parse(c.data).htmlRenderedChunk;if(d){var f=null;if("text"===c.lastEventId)f=l.handleChunk(d);else if("feedback_chunk"===c.lastEventId)f=
g.handleChunk(d);else if("sensitive_chunk"===c.lastEventId||"softlanding_error_chunk"===c.lastEventId||"internal_error_chunk"===c.lastEventId)h.extend({streamingState:e.streamingState.ERROR}),z.handleChunk(d,c.lastEventId);a.afterChunkRender(c,f)}}}}})});d.now("dpx-rex-nile-inline-widget-instrumentation").execute(function(f){f||d.when("A","nice-srp-utils","nile-inline-state-manager","ready").register("dpx-rex-nile-inline-widget-instrumentation",function(a,l,d){function g(b){var k=Array.from(arguments).slice(1,
arguments.length);return function(){for(var c=arguments.length,a=Array(c),e=0;e<c;e++)a[e]=arguments[e];b.apply(void 0,k.concat(a))}}function h(b){b=[b.dataset.blueMetrics,b.dataset.actionId];b=b.filter(function(b){return b!==p&&null!==b&&""!==b});return b.join(":")}function e(b){for(var k=Object.keys(b),c=0;c<k.length;c++){var a=k[c],e=b[a];null===e||e===p?e="":"number"===typeof e&&(e=e.toString());b[a]=e}return b}function c(b,k){var c=l.getAppInfo(),a=l.getAppContext(),m=d.getState();b=Object.assign({timestamp:v(new Date),
producerId:"mshop-nile",metadata:'{"program":"BLUE_DPX"}',isBeta:!1,deviceTypeId:a&&a.di&&a.di.dti||"",directedCustomerId:m.directedCustomerId||"",appVersion:c&&c.version||"",locale:m.locale||"UNKNOWN",marketplaceId:m.marketplaceId||"UNKNOWN",uxSessionId:"",sessionId:l.getAppSessionId()||""},b);"undefined"!==typeof ue&&ue.event(e(b),"mshop-nile",k)}function f(b,k){"CONTEXT_CHUNK"===k.type?b.requestId||(b.requestId=JSON.parse(k.data).requestContext.requestId,B(b,b.actionId||"ANSWER"),b.searchTrigger!==
p&&c({schemaId:"mshop.nile.events.4",eventTimeUTC:v(b.requestStartAt),nileRequestId:b.requestId,clickstreamRequestId:null,eventName:"SEARCH_TRIGGER",eventDetail:b.searchTrigger},"mshop.nile.events.4")):"chunk"===k.type&&M.includes(k.lastEventId)&&b.chunks.addFromEvent(k)}function z(b,k){if(k=k[0])k.isIntersecting||!b.answer.impressingStartAt?b.answer.impressingStartAt=new Date:(b.answer.impressingEndAt=new Date,0===k.boundingClientRect.width&&0===k.boundingClientRect.height?w(b,"SEARCH_RESULTS_CLEARED"):
w(b,"SCROLLED_AWAY"),b.answer.impressingStartAt=null,b.answer.impressingEndAt=null)}function t(b,k){var c=b.luggage,a=c.items[b.key];if(k=k[0])k.isIntersecting?(a.impressingStartAt=new Date,c.visibleElems.add(a.key)):a.impressingStartAt&&(a.impressingEndAt=new Date,a.reason=0===k.boundingClientRect.width&&0===k.boundingClientRect.height?"SEARCH_RESULTS_CLEARED":"SCROLLED_AWAY",x(b),a.impressingStartAt=null,a.impressingEndAt=null,c.visibleElems.remove(a.key))}function m(b){var k=b.luggage.items[b.key];
k.impressingStartAt&&"visible"!==document.visibilityState&&(document.contains(k.elem)&&(k.impressingEndAt=new Date,k.reason="PAGE_HIDDEN",x(b)),document.removeEventListener("visibilitychange",k.pageVisibilityChangeListener))}function A(b){b.answer.impressingStartAt&&"visible"!==document.visibilityState&&(b.answer.impressingEndAt=new Date,w(b,"PAGE_HIDDEN"),b.answer.observer.unobserve(b.answer.elem),document.removeEventListener("visibilitychange",b.answer.visibilityChangeListener))}function q(b,k,
c){c=c.find("[data-blue-metrics]");var a=g(G,b);b.visibilityChangeListenerForLatency=a;document.addEventListener("visibilitychange",b.visibilityChangeListenerForLatency);(a=document.getElementById("dpx-rex-nile-search-text-input"))&&!a.hasAttribute("listenerOnFocus")&&(a.addEventListener("touchend",g(Q,b)),a.setAttribute("listenerOnFocus","true"));(a=document.getElementsByClassName("dpx-rex-nice-clear-widget")[0])&&!a.hasAttribute("listenerOnErase")&&(a.addEventListener("touchend",g(R,b)),a.setAttribute("listenerOnErase",
"true"));E();for(a=0;a<c.length;a++){var e=c[a],d=h(e);b.items[d]?b.items[d].elem=e:(b.items[d]={key:d,elem:e,name:e.dataset.blueMetrics,detail:e.dataset.actionId},D(b,k,e.dataset.actionId));e={luggage:b,key:d};d=e;var l=d.luggage.items[d.key];l.elem.observer||(l.elem.observer=new IntersectionObserver(g(t,d),{threshold:.85}),l.elem.observer.observe(l.ghost||l.elem),l.pageVisibilityChangeListener||(l.pageVisibilityChangeListener=g(m,d),document.addEventListener("visibilitychange",l.pageVisibilityChangeListener)));
d=e.luggage.items[e.key];d.elem.clickListener||(d.elem.clickListener=g(S,e),d.elem.addEventListener("click",d.elem.clickListener))}}function E(b){var a=document.getElementById("dpx-rex-nile-search-text-input");a&&!a.hasAttribute("listenerOnErase")&&(a.addEventListener("input",function(){!H&&0<a.value.length?H=!0:H&&0===a.value.length&&(c({schemaId:"mshop.nile.events.4",eventTimeUTC:(new Date).toISOString(),nileRequestId:C.luggage&&C.luggage.requestId,clickstreamRequestId:null,eventName:"SEARCH_INPUT_ERASE",
eventDetail:"CLEAR"},"mshop.nile.events.4"),H=!1)}),a.setAttribute("listenerOnErase","true"))}function J(b,c,e){if("chunk"===c.type&&M.includes(c.lastEventId)){var k=b.chunks.markAsRendered(c);if("text"===c.lastEventId){if(c=document.getElementById("dpx-rex-nile-inline-answer-text-container")){var m=b.answer,d=document.getElementById("ghost");if(!d){var h=document.createElement("div");a.$(h).addClass("nile-inline-ghost");d=document.createElement("div");d.id="ghost";d.className="ghost-inner-div";a.$(h).append(d);
a.$(c).append(h)}m.ghost=d;b.answer.elem=c;D(b,k,"ANSWER");c=b.answer;c.observer||(c.observer=new IntersectionObserver(g(z,b),{threshold:.85}),c.visibilityChangeListener=g(A,b),document.addEventListener("visibilitychange",c.visibilityChangeListener),c.observer.observe(c.ghost||c.elem));q(b,k,e);k=e.find("#nile-category-cards-mobile-carousel");e=e.find("[id^\x3dsection_groupId_related_questions]");n(b,k,"category_list_carousel_horizontal");n(b,e,"FOLLOW_ON_PILLS_OUTSIDE_SEEMORE")}}else"feedback_chunk"===
c.lastEventId&&(D(b,k,"ANSWER_FEEDBACK"),k=e.find("#dpx-rex-nile-thumbs-up")[0],e=e.find("#dpx-rex-nile-thumbs-down")[0],k&&e&&(k.addEventListener("touchend",g(r,b),{once:!0}),e.addEventListener("touchend",g(K,b),{once:!0})))}}function P(b,c){b.chunks.addFromEvent(c)}function y(b,a,e){b.requestEndAt=new Date;a=b.chunks.markAsRendered(a);var k=e[0].matches("[data-blue-request-id]")&&e[0]||e[0].querySelector("[data-blue-request-id]");k&&(b.requestId=k.dataset.blueRequestId,c({schemaId:"mshop.nile.events.4",
eventTimeUTC:v(b.requestStartAt),nileRequestId:b.requestId,clickstreamRequestId:null,eventName:"INVOKE_NILE",eventDetail:b.actionId||"default_pills_fetched"},"mshop.nile.events.4"),B(b),q(b,a,e),n(b,e,"DEFAULT_PILLS"))}function r(b,c){I(b,"THUMBS_UP")}function K(b,c){I(b,"THUMBS_DOWN")}function n(b,c,a){c&&(c=c.find(".a-carousel-viewport")[0])&&c.addEventListener("scroll",g(T,b,a),{once:!0})}function U(b,c){b.requestEndAt=new Date;document.removeEventListener("visibilitychange",b.visibilityChangeListenerForLatency)}
function G(b){if("visible"!==document.visibilityState&&!b.requestEndAt){b.interruptedAt=new Date;var a=b.flow.toUpperCase(),e=b.chunks.maybeGetLastRendered();c({schemaId:"mshop.nile.latency.6",nileRequestId:b.requestId,elementId:a,seqId:e?e.index+1:0,requestStartTimeUTC:v(b.requestStartAt),renderingStartTimeUTC:"",renderingEndTimeUTC:"",interruptedTimeUTC:v(b.interruptedAt)},"mshop.nile.latency.6");0<Object.keys(b.items).length||(document.removeEventListener("visibilitychange",b.visibilityChangeListenerForLatency),
N(b,"PAGE_HIDDEN"))}}function w(b,a){c({schemaId:"mshop.nile.impressions.1",nileRequestId:b.requestId,elementId:"ANSWER",seqId:0,requestStartTimeUTC:v(b.requestStartAt),impressionStartTimeUTC:v(b.answer.impressingStartAt),impressionEndTimeUTC:v(b.answer.impressingEndAt),impressionEndReason:a},"mshop.nile.impressions.1")}function x(b){var a=b.luggage;b=a.items[b.key];c({schemaId:"mshop.nile.impressions.1",nileRequestId:a.requestId,elementId:b.detail||b.name,seqId:b.chunkId||0,requestStartTimeUTC:v(a.requestStartAt),
impressionStartTimeUTC:v(b.impressingStartAt),impressionEndTimeUTC:v(b.impressingEndAt),impressionEndReason:b.reason},"mshop.nile.impressions.1")}function D(b,a,e){c({schemaId:"mshop.nile.latency.6",nileRequestId:b.requestId,elementId:e,seqId:a.index,requestStartTimeUTC:v(b.requestStartAt),renderingStartTimeUTC:v(a.renderingStartAt),renderingEndTimeUTC:v(a.renderingEndAt),interruptedTimeUTC:""},"mshop.nile.latency.6")}function B(b,a){c({schemaId:"mshop.nile.events.4",eventTimeUTC:v(b.requestStartAt),
nileRequestId:b.requestId,clickstreamRequestId:null,eventName:"INVOKE_NILE_BACKEND_API",eventDetail:a},"mshop.nile.events.4")}function I(b,a){c({schemaId:"mshop.nile.events.4",eventTimeUTC:v(new Date),nileRequestId:b.requestId,clickstreamRequestId:null,eventName:"MAIN_FEEDBACK_REQUEST",eventDetail:a},"mshop.nile.events.4")}function S(b){var a=b.luggage.items[b.key];c({schemaId:"mshop.nile.events.4",eventTimeUTC:v(new Date),nileRequestId:b.luggage.requestId,clickstreamRequestId:null,eventName:a.name,
eventDetail:a.detail},"mshop.nile.events.4")}function T(b,a){c({schemaId:"mshop.nile.events.4",eventTimeUTC:v(new Date),nileRequestId:b.requestId,clickstreamRequestId:null,eventName:"SCROLL_BUTTON_CAROUSEL",eventDetail:a},"mshop.nile.events.4")}function Q(b){c({schemaId:"mshop.nile.events.4",eventTimeUTC:(new Date).toISOString(),nileRequestId:C.luggage&&C.luggage.requestId,clickstreamRequestId:null,eventName:"SEARCH_INPUT_FOCUS",eventDetail:"TOUCH"},"mshop.nile.events.4")}function R(b){c({schemaId:"mshop.nile.events.4",
eventTimeUTC:(new Date).toISOString(),nileRequestId:b.requestId,clickstreamRequestId:null,eventName:"CLEAR_BUTTON_PRESS",eventDetail:"clear_button_touch"},"mshop.nile.events.4");H=!1}function N(b,a){c({schemaId:"mshop.nile.events.4",eventTimeUTC:v(b.interruptedAt),nileRequestId:b.requestId,clickstreamRequestId:null,eventName:"CONVERSATION_ABANDONMENT",eventDetail:a},"mshop.nile.events.4")}function L(){var b=document.getElementById("dpx-rex-nile-search-text-input");return b&&b.value||""}function O(){if("visible"!==
document.visibilityState){var b=L();""!==b&&b!==C.textInputValue&&(N({interruptedAt:new Date},"QUERY_NOT_SUBMITTED"),document.removeEventListener("visibilitychange",O))}}function v(b){return b instanceof Date?b.toISOString():""}function V(b){return(b=(b=b&&b.event&&b.event.refTarget)&&b.closest("[data-blue-metrics]"))&&b.dataset&&b.dataset.actionId}function W(b){var a=b.flow;var c="answer"!==b.flow?p:b.event.triggerSource||"ENTER_PRESSED_SOURCE";return{flow:a,searchTrigger:c,actionId:V(b),chunks:{length:0,
addFromEvent:function(b){var a={event:b,renderingStartAt:new Date,index:this.length};b.index=a.index;return[].push.call(this,a)},getFromEvent:function(b){return this[b.index]},maybeGetLastRendered:function(){for(var b=this.length,a=0;a<b&&this[a].renderingEndAt;a++);return 0===a?null:this[a-1]},markAsRendered:function(b){b=this.getFromEvent(b);b.renderingEndAt=new Date;return b}},requestStartAt:new Date,requestEndAt:null,answer:{},visibleElems:{length:0,add:function(b){this[b]||[].push.call(this,
b)},remove:function(b){delete this[b]}},items:{}}}var M=["text","feedback_chunk"],C={textInputValue:L()},H=!1;document.addEventListener("visibilitychange",O);return{executeAndLogMetrics:function(b,a){a=W(a);var c=C.luggage;c&&(document.removeEventListener("visibilitychange",c.visibilityChangeListenerForLatency),c.answer&&c.answer.observer&&(c.answer.observer.unobserve(c.answer.elem),document.removeEventListener("visibilitychange",c.answer.visibilityChangeListener)));C.luggage=a;C.textInputValue=L();
a={beforeChunk:g(f,a),afterChunkRender:g(J,a),afterFullRender:g(U,a),beforePillRender:g(P,a),afterPillRender:g(y,a)};b(a)},buildContext:function(b,a){return{flow:b,event:a}}}})});d.now("nile-inline-answer-streamer").execute(function(f){f||d.when("A","nile-inline-html-truncator","nile-inline-chunk-renderer","nile-inline-loader-utils","nile-inline-csrf","nile-inline-event-stream-builder","nile-inline-uuid-generator","nile-inline-container-manager","nile-inline-search-input-button-controller","nile-inline-state-manager",
"dpx-rex-nile-inline-display-utils","dpx-rex-nile-inline-widget-instrumentation","dpx-nile-inline-constants","askSearch","ready").register("nile-inline-answer-streamer",function(a,d,f,g,h,e,c,u,n,t,m,A,q,E){function l(a,c){return function(e){a===w&&(f.renderChunk(e,c),t.extend({streamingState:q.streamingState.ANSWER_LOADING}))}}function z(a){return function(){a.close();t.extend({streamingState:q.streamingState.ERROR});m.displayGenericError()}}function y(a,c){return function(){w=null;a.close();t.getState().streamingState!==
q.streamingState.ERROR&&t.extend({streamingState:q.streamingState.ANSWER_RENDERED});c.afterFullRender();g.hideLoader();g.hideTrailingLoader()}}function r(c,e){u.clearAnswerContainer();n.showClearButton();e&&(F(),t.extend({streamingState:q.streamingState.ANSWER_LOADING}),d.setIsAnswerExpanded(!1),m.hide("#dpx-rex-nile-inline-default-pills-container"),c&&a.$("#dpx-rex-nile-search-text-input").val(c),g.showLoader(),g.showTrailingLoader())}function K(a,c,e){a=A.buildContext(c,a);A.executeAndLogMetrics(function(a){e(a)},
a)}function x(a){var c=t.getState(),e=c.streamingState===q.streamingState.ERROR;c=(c.streamingState===q.streamingState.ANSWER_RENDERED||c.streamingState===q.streamingState.ANSWER_LOADING)&&a===p;return a?e?!0:c?!1:!0:!1}function F(){G&&G.close()}var G=null,w=null;t.extend({streamingState:q.streamingState.NOT_STARTED});var p;return{streamAnswer:function(a,d,m){var g=a.query;if(x(g)){p=g;var f=t.getState().blueEnabled;r(g,f);f&&K(d,m,function(d){var m=c.generateUuid();w=m;var g=h.getRawCsrfToken("#rufusInlineCsrfTokenContainer"),
f=e.buildStreamingEndpointCall("/rufus/web/renderedAnswer?");m=l(m,d);var u=z(f);d=y(f,d);f.setErrorCallback(u);f.addEventListener("CONTEXT_CHUNK",m);f.addEventListener("chunk",m);f.addEventListener("close",d);f.startPostStream(a,g,6E4);G=f});E.executeSearch(a.asin,g,f)}},closeStream:F}})});var n=p&&p.__assign||function(){n=Object.assign||function(d){for(var a,f=1,z=arguments.length;f<z;f++){a=arguments[f];for(var g in a)Object.prototype.hasOwnProperty.call(a,g)&&(d[g]=a[g])}return d};return n.apply(this,
arguments)};d.now("nile-inline-request-builder").execute(function(f){f||d.when("A","nile-inline-state-manager","ready").register("nile-inline-request-builder",function(a,d){function f(a){return(a=(a=(a=a&&a.$target)&&a.closest("[data-action-url]")[0])&&a.dataset)?{actionUrl:a.actionUrl}:{}}function g(a,c,g){var e=d.getState();return n({query:a,searchSource:c,asin:e.asin,programId:"BLUE_DPX_REX"},g)}function h(){var a=d.getState();return{programId:"BLUE_DPX_REX",conversationId:a&&a.conversationHistoryId||
"",turnRequestId:a&&a.requestId||"",gmtTime:(new Date).toISOString()}}return{buildFollowOnPillClickRequest:function(a,c){return g(a,"BLUE_FOLLOWON_PILL_CLICK_SOURCE",f(c))},buildDefaultPillClickRequest:function(a,c){return g(a,"BLUE_PILL_CLICK_SOURCE",f(c))},buildSearchInputRequest:function(a){return g(a,"LIVE_SEARCH_SOURCE",{})},buildFocusedOutRequest:function(a){return g(a,"BLUE_FOCUS_OUT_SOURCE",{})},buildFeedbackRequest:function(a,c,d){return n(n({feedbackType:a,mainFeedback:c},d),h())},buildDetailFeedbackRequest:function(a,
c){return n({feedbackType:"DETAIL_FEEDBACK",detailFeedback:a,freeformFeedback:c},h())}}})});d.now("dpx-rex-nile-inline-display-utils").execute(function(f){f||d.when("A","nile-inline-loader-utils","ready").register("dpx-rex-nile-inline-display-utils",function(a,d){function f(e){a.$(e).removeClass(h.join(" "))}function g(e){return h.some(function(c){return a.$(e).hasClass(c)})}var h=["dpx-rex-nile-inline-hidden","nile-inline-hidden","askHidden"];return{show:f,hide:function(e){a.$(e).addClass("dpx-rex-nile-inline-hidden")},
isHidden:g,displayGenericError:function(){g("#dpx-rex-nile-inline-answer-text-container-error")&&(f("#dpx-rex-nile-inline-answer-generic-error"),d.hideLoader(),d.hideTrailingLoader(),f("#dpx-rex-nile-inline-answer-container"),f("#nile-inline-ai-generated-label"))}}})});d.now("nile-inline-container-manager").execute(function(f){f||d.when("A","nile-inline-feedback-actions","dpx-rex-nile-inline-display-utils","nile-inline-state-manager","dpx-nile-inline-constants","nile-inline-loader-utils","ready").register("nile-inline-container-manager",
function(a,d,f,g,h,e){var c=a.$;return{clearAnswerContainer:function(){g.extend({streamingState:h.streamingState.NOT_STARTED});f.hide("#dpx-rex-nile-inline-answer-container");c("#dpx-rex-nile-inline-answer-text-container").empty();c("#dpx-rex-nile-inline-answer-container-truncating-sandbox").find(".a-truncate-full").empty();c("#dpx-rex-nile-inline-followon-pills-outside-container").empty();d.setFeedbackSent(!1);d.clearFeedbackContainer();c("#dpx-rex-nile-inline-answer-text-container-error").empty();
e.hideLoader();e.hideTrailingLoader();f.hide("#dpx-rex-nile-inline-data-container, #dpx-rex-nile-inline-answer-text-container-error, #nile-inline-ai-generated-label, #dpx-rex-nile-inline-answer-generic-error");c("#dpx-rex-nile-inline-answer-text-container-error, #dpx-rex-nile-inline-answer-generic-error").removeClass("nile-inline-text-container-collapsed-error")}}})});d.now("nile-inline-html-truncator").execute(function(f){f||d.when("A","nile-inline-feedback-actions","nile-inline-loader-utils","nile-inline-state-manager",
"dpx-nile-inline-constants","dpx-rex-nile-inline-display-utils").register("nile-inline-html-truncator",function(a,d,f,g,h,e){function c(a){a[0].style.removeProperty("height");a.find("#"+l(a,"html-truncator-marker")).addClass("dpx-rex-nile-inline-hidden")}function l(a,c){return a[0].id?a[0].id+"-"+c:c}var z=["absolute","fixed"],t=!1;return{maybeTruncate:function(e,d,g){if(t)return!1;var h=l(e,"html-truncator-marker");var m=l(e,"sandbox"),u=e.parent().find("#"+m);u[0]||(u=e.clone(),u[0].id=m,u.addClass("a-offscreen"),
e.after(u));var y=u;var r=e.children();y.empty();m=y[0].getBoundingClientRect().height;y.append("\x3cbr\x3e");u=y[0].getBoundingClientRect().height-m;var n=0,q=null,p=0;m=!1;for(var A=0;A<r.length;A++){var w=0;if(m)break;if(-1===z.indexOf(x.getComputedStyle(r[A]).position)&&r[A].id!==h){var F=r[A].childNodes;y.empty();for(var D=0;D<F.length;D++){var B=F[D];if(B.nodeType!==Node.TEXT_NODE||""!==B.textContent.trim()){var I=B.nodeType===Node.TEXT_NODE?"inline":x.getComputedStyle(B).display;if(I&&I.startsWith("inline")&&
n<=g)if(w=B.cloneNode(!0),w.removeAttribute&&w.removeAttribute("id"),y.append(w),w=Math.round(y[0].offsetHeight/u),n+w===g)q=B;else if(n+w>g){m=!0;p=q?0:n+w-g;q=q||B;break}}}n+=w}}m?(h=q,g=p,y=l(e,"html-truncator-marker"),r=e.find("#"+y),0===r.length?(d=d.clone(!0),d.removeClass("nile-inline-hidden"),r=a.$(document.createElement("span")),r[0].id=y,r.addClass("nile-inline-truncation-overflow-marker"),r.append(d),e.append(r)):r.removeClass("dpx-rex-nile-inline-hidden"),d=r,y=d[0].getBoundingClientRect(),
r=document.createRange(),r.selectNode(h),p=r.getBoundingClientRect(),r=e[0].getBoundingClientRect(),n=p.height/Math.round(p.height/u),e[0].style.setProperty("height",r.height-(y.bottom-(p.bottom-g*n))+(u-n)/2+"px"),e=document.createElement("span"),h.nodeType===Node.TEXT_NODE?"BR"===h.tagName?h.before(e):h.after(e):"BR"===h.tagName?h.before(e):h.append(e),u=r.width-d.children()[0].offsetWidth-10,h=e.offsetLeft+10,0===g&&h<u?d[0].style.setProperty("left",h+"px"):d[0].style.removeProperty("left"),e.remove(),
f.hideTrailingLoader()):c(e);return m},expand:c,registerTruncationActions:function(){a.declarative("nile-inline-see-more","click",function(e){c(a.$("#dpx-rex-nile-inline-answer-text-container"));t=!0;g.getState().streamingState===h.streamingState.ANSWER_LOADING&&f.showTrailingLoader()});a.declarative.create(a.$("#dpx-rex-nile-inline-see-more-action"),"nile-inline-see-more",{})},getIsAnswerExpanded:function(){return t},setIsAnswerExpanded:function(a){t=a}}})});d.now("dpx-nile-inline-constants").execute(function(f){f||
d.declare("dpx-nile-inline-constants",{streamingState:{NOT_STARTED:0,ANSWER_LOADING:1,ANSWER_RENDERED:2,ERROR:3}})});d.now("nile-inline-search-input-button-controller").execute(function(f){f||d.when("dpx-rex-nile-inline-display-utils","nile-inline-state-manager","ready").register("nile-inline-search-input-button-controller",function(a,d){return{showSubmitButton:function(){var f=d.getState().blueEnabled;a.hide("#dpx-rex-nice-clear-button");f&&a.show("#dpx-rex-nile-submit-button")},showClearButton:function(){a.hide("#dpx-rex-nile-submit-button");
a.show("#dpx-rex-nice-clear-button")}}})});d.now("nile-inline-dpx-reset-widget").execute(function(f){f||d.when("A","nile-inline-default-pill-actions","nile-inline-container-manager","nile-inline-answer-streamer","nile-inline-html-truncator","nile-inline-search-input-button-controller","askSearch").register("nile-inline-dpx-reset-widget",function(a,d,f,g,h,e,c){return function(){g.closeStream();f.clearAnswerContainer();h.setIsAnswerExpanded(!1);d.showDefaultPills();a.$("#dpx-rex-nile-search-text-input").val("");
e.showSubmitButton();c.clearSearch()}})});d.now("nile-inline-clear-button-actions").execute(function(f){f||d.when("A","nile-inline-dpx-reset-widget").register("nile-inline-clear-button-actions",function(a,d){return{registerClearButtonActions:function(){a.declarative("dpx-rex-nice-clear-button-click","click",function(a){d()})}}})});d.now("nile-inline-default-pill-actions").execute(function(f){f||d.when("A","nile-inline-request-builder","nile-inline-answer-streamer","dpx-rex-nile-inline-display-utils",
"ready").register("nile-inline-default-pill-actions",function(a,d,f,g){return{registerDefaultPillActions:function(){a.declarative("dpx-rex-nile-inline-pill-clicked","click",function(a){var e=d.buildDefaultPillClickRequest(a.$target[0].value,a);f.streamAnswer(e,a,"pills")})},showDefaultPills:function(){g.show("#dpx-rex-nile-inline-default-pills-container")}}})});d.now("nile-inline-search-input-actions").execute(function(f){f||d.when("A","nile-inline-answer-streamer","nile-inline-search-input-button-controller",
"nile-inline-request-builder","nile-inline-state-manager","nile-inline-dpx-reset-widget","ready").register("nile-inline-search-input-actions",function(a,d,f,g,h,e){function c(a){var c=l("#dpx-rex-nile-search-text-input");c=l.trim(c.val());c="focusout"===a.type?g.buildFocusedOutRequest(c):g.buildSearchInputRequest(c);d.streamAnswer(c,a,"answer")}var l=a.$,n=a.debounce(c,200);return{registerSearchInputActions:function(){var a=h.getState().blueEnabled;l("#dpx-rex-nile-submit-button").click(function(a){a.preventDefault();
c({triggerSource:"SUBMIT_BUTTON_SOURCE"})});a?(l("#dpx-rex-nile-search-text-input").focusout(c),l("#dpx-rex-nile-search-text-input").keyup(function(a){""===a.target.value&&e();13!==a.which?f.showSubmitButton():(l("#dpx-rex-nile-search-text-input").blur(),c(a))})):l("#dpx-rex-nile-search-text-input").keyup(function(a){""===a.target.value&&e();n(a)})}}})});d.now("nile-inline-feedback-actions").execute(function(f){f||d.when("A","nile-inline-csrf","nile-inline-request-builder","a-popover","dpx-rex-nile-inline-display-utils",
"a-button","ready").register("nile-inline-feedback-actions",function(a,d,f,g,h,e){function c(){h.hide("#ask-blue-ai-generated-label");h.show("#ask-feedback-success-text-container")}function l(a){"THUMBS_UP"===a?(h.hide("#thumbs-up-not-selected"),h.show("#thumbs-up-selected"),q.forEach(h.hide),c()):(h.hide("#thumbs-down-not-selected"),h.show("#thumbs-down-selected"),h.show("#ask-blue-feedback-box"))}function n(){a.$("#ask-blue-feedback-box").remove();g.remove("ask-blue-detail-feedback");q.forEach(h.hide);
c()}function t(c){a.$.ajax({url:"/rufus/web/feedback?",data:c,dataType:"json",type:"POST",timeout:1E4,headers:{"anti-csrftoken-a2z":d.getRawCsrfToken("#rufusInlineCsrfTokenContainer"),"Content-Type":"application/json"}})}function m(){var c=a.$(".ask-blue-feedback-checkbox:checked").map(function(c,d){return a.$(d).val()}).get(),d;a.$("#ask-blue-feedback-option-freetext").is(":checked")&&(d=a.$("#ask-blue-feedback-textbox").val().substring(0,500));t(JSON.stringify(f.buildDetailFeedbackRequest(c,d)))}
var p=!1,q=["#thumbs-up-not-selected","#thumbs-down-not-selected","#ask-blue-space-between-thumbs"];return{registerFeedbackActions:function(){a.declarative("ask-blue-thumbs-up-click","click keypress",function(){p||(t(JSON.stringify(f.buildFeedbackRequest("MAIN_FEEDBACK","THUMBS_UP",void 0))),l("THUMBS_UP"),p=!0)});a.declarative("ask-blue-thumbs-down-click","click keypress",function(){p||(t(JSON.stringify(f.buildFeedbackRequest("MAIN_FEEDBACK","THUMBS_DOWN",void 0))),l("THUMBS_DOWN"),p=!0)});a.declarative("ask-blue-feedback-option-click",
"click",function(){1<=a.$(".ask-blue-feedback-checkbox:checked").length?(e("#ask-blue-feedback-submit").enable(),a.$("#ask-blue-feedback-submit").prop("disabled",!1)):(e("#ask-blue-feedback-submit").disable(),a.$("#ask-blue-feedback-submit").prop("disabled",!0));a.$("#ask-blue-feedback-option-freetext").is(":checked")?h.show("#ask-blue-feedback-textbox"):h.hide("#ask-blue-feedback-textbox")});a.declarative("ask-blue-feedback-close-click","click",function(){n()});a.declarative("ask-blue-feedback-cancel-click",
"click",function(){n()});a.declarative("ask-blue-feedback-submit-click","click",function(){m();n()})},setFeedbackSent:function(a){p=a},hideFeedback:function(){h.hide("#dpx-rex-nile-inline-feedback-container")},showFeedback:function(){h.show("#dpx-rex-nile-inline-feedback-container")},clearFeedbackContainer:function(){a.$("#dpx-rex-nile-inline-feedback-container").empty()}}})});d.now("nile-inline-followon-pill-actions").execute(function(f){f||d.when("A","jQuery","nile-inline-request-builder","nile-inline-answer-streamer",
"ready").register("nile-inline-followon-pill-actions",function(a,d,f,g){return{registerFollowOnPillActions:function(){a.declarative("followon-pill-click","click keypress",function(d){var e=f.buildFollowOnPillClickRequest(d.$target[0].value,d);g.streamAnswer(e,d,"pills");e=a.$("#dpx-rex-nice-widget-container");d=e.offset().top;e=d+e.outerHeight();var c=a.$(x).scrollTop(),h=c+a.$(x).height();(e<c||d>h)&&a.$(x).scrollTop(d-(0<a.$(".s-mobile-toolbar-offscreen").length?0:a.$(".s-mobile-toolbar-sticky")?
a.$(".s-mobile-toolbar-sticky").outerHeight():0))})}}})});d.now("nile-inline-widget").execute(function(f){f||d.when("A","jQuery","nile-inline-feedback-actions","nile-inline-default-pill-actions","nile-inline-html-truncator","nile-inline-answer-chunk-handler","nile-inline-followon-pill-actions","dpx-rex-nile-inline-widget-instrumentation","nile-inline-clear-button-actions","nile-inline-search-input-actions","nile-inline-collapse-bottom-sheet","nile-inline-element-prefix-utils","askSearch","askPostQuestion",
"nile-inline-state-manager","ready").register("nile-inline-widget",function(a,d,f,g,h,e,c,n,p,t,m,x,q,E,J){x.setupElementPrefix("dpx-rex");var l=d("#dpx-rex-nile-inline-default-pills-container");f.registerFeedbackActions();g.registerDefaultPillActions();h.registerTruncationActions();c.registerFollowOnPillActions();p.registerClearButtonActions();m.registerCollapseBottomSheetActions();t.registerSearchInputActions();q.setupExpander();E.registerDeclarativeActions();J.getState().blueEnabled&&(a=n.buildContext("pills"),
n.executeAndLogMetrics(function(a){var c={type:"default_pills"};a.beforePillRender(c);var e=d(l);a.afterPillRender(c,e)},a))})})})()});
/* ******** */
